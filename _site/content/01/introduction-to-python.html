<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>Python for the practicing neuroscientist</title>
  <meta name="description" content="# Python for the practicing neuroscientistTo be frank:  this notebook is rather boring.  Throughout all of the case studies, we will use the software package...">

  <link rel="canonical" href="https://mark-kramer.github.io/Case-Studies-Python/content/01/introduction-to-python.html">
  <link rel="alternate" type="application/rss+xml" title="Case Studies in Neural Data Analysis" href="https://mark-kramer.github.io/Case-Studies-Python/feed.xml">

  <meta property="og:url"         content="https://mark-kramer.github.io/Case-Studies-Python/content/01/introduction-to-python.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Python for the practicing neuroscientist" />
<meta property="og:description" content="# Python for the practicing neuroscientistTo be frank:  this notebook is rather boring.  Throughout all of the case studies, we will use the software package..." />
<meta property="og:image"       content="https://mark-kramer.github.io/Case-Studies-Python/images/logo/logo.png" />

<meta name="twitter:card" content="summary">


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage": "https://mark-kramer.github.io/Case-Studies-Python/content/01/introduction-to-python.html",
  "headline": "Python for the practicing neuroscientist",
  "datePublished": "2020-06-11T19:24:49-04:00",
  "dateModified": "2020-06-11T19:24:49-04:00",
  "description": "# Python for the practicing neuroscientistTo be frank:  this notebook is rather boring.  Throughout all of the case studies, we will use the software package...",
  "author": {
    "@type": "Person",
    "name": "Mark Kramer and Uri Eden"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "https://mark-kramer.github.io/Case-Studies-Python",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "https://mark-kramer.github.io/Case-Studies-Python",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/Case-Studies-Python/assets/css/styles.css">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/Case-Studies-Python/images/logo/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<!-- (mostly) copied from nbconvert configuration -->
<!-- https://github.com/jupyter/nbconvert/blob/master/nbconvert/templates/html/mathjax.tpl -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    // Center justify equations in code and markdown cells. Elsewhere
    // we use CSS to left justify single line equations in code cells.
    displayAlign: 'center',
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}},
        linebreaks: { automatic: true },
    },
    
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML' async></script>


  <!-- DOM updating function -->
  <script src="/Case-Studies-Python/assets/js/page/dom-update.js"></script>

  <!-- Selectors for elements on the page -->
  <script src="/Case-Studies-Python/assets/js/page/documentSelectors.js"></script>

  <!-- Define some javascript variables that will be useful in other javascript -->
  <script>
    const site_basename = '/Case-Studies-Python';
  </script>

  <!-- Add AnchorJS to let headers be linked -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js" async></script>
  <script src="/Case-Studies-Python/assets/js/page/anchors.js" async></script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/turbolinks/5.2.0/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->


<!-- Display Thebelab button in each code cell -->
<script>
/**
 * Set up thebelab button for code blocks
 */

const thebelabCellButton = id =>
  `<a id="thebelab-cell-button-${id}" class="btn thebebtn o-tooltip--left" data-tooltip="Interactive Mode">
    <img src="/Case-Studies-Python/assets/images/edit-button.svg" alt="Start thebelab interactive mode">
  </a>`


const addThebelabButtonToCodeCells =  () => {

  const codeCells = document.querySelectorAll('div.input_area > div.highlight:not(.output) pre')
  codeCells.forEach((codeCell, index) => {
    const id = codeCellId(index)
    codeCell.setAttribute('id', id)
    if (document.getElementById("thebelab-cell-button-" + id) == null) {
      codeCell.insertAdjacentHTML('afterend', thebelabCellButton(id));
    }
  })
}

initFunction(addThebelabButtonToCodeCells);
</script>


<script src="https://unpkg.com/thebelab@latest/lib/index.js" async></script>
<script>
    /**
     * Add attributes to Thebelab blocks
     */

    const initThebelab = () => {
        const addThebelabToCodeCells = () => {
            console.log("Adding thebelab to code cells...");
            // If Thebelab hasn't loaded, wait a bit and try again. This
            // happens because we load ClipboardJS asynchronously.
            if (window.thebelab === undefined) {
                setTimeout(addThebelabToCodeCells, 250)
            return
            }

            // If we already detect a Thebelab cell, don't re-run
            if (document.querySelectorAll('div.thebelab-cell').length > 0) {
                return;
            }

            // Find all code cells, replace with Thebelab interactive code cells
            const codeCells = document.querySelectorAll('.input_area pre')
            codeCells.forEach((codeCell, index) => {
                const id = codeCellId(index)

                // Clean up the language to make it work w/ CodeMirror and add it to the cell
                dataLanguage = ""
                dataLanguage = detectLanguage(dataLanguage);
                codeCell.setAttribute('data-language', dataLanguage)
                codeCell.setAttribute('data-executable', 'true')

                // If the code cell is hidden, show it
                var inputCheckbox = document.querySelector(`input#hidebtn${codeCell.id}`);
                if (inputCheckbox !== null) {
                    setCodeCellVisibility(inputCheckbox, 'visible');
                }
            });

            // Remove the event listener from the page so keyboard press doesn't
            // Change page
            document.removeEventListener('keydown', initPageNav)
            keyboardListener = false;

            // Init thebelab
            thebelab.bootstrap();

            // Remove copy buttons since they won't work anymore
            const copyAndThebeButtons = document.querySelectorAll('.copybtn, .thebebtn')
            copyAndThebeButtons.forEach((button, index) => {
                button.remove();
            });

            // Remove outputs since they'll be stale
            const outputs = document.querySelectorAll('.output *, .output')
            outputs.forEach((output, index) => {
                output.remove();
            });

            // Find any cells with an initialization tag and ask ThebeLab to run them when ready
            var thebeInitCells = document.querySelectorAll('div.tag_thebelab-init');
            thebeInitCells.forEach((cell) => {
                console.log("Initializing ThebeLab with cell: " + cell.id);
                cell.querySelector('.thebelab-run-button').click();
            });
        }

        // Add event listener for the function to modify code cells
        const thebelabButtons = document.querySelectorAll('[id^=thebelab], [id$=thebelab]')
        thebelabButtons.forEach((thebelabButton,index) => {
            if (thebelabButton === null) {
                setTimeout(initThebelab, 250)
                return
            };
            thebelabButton.addEventListener('click', addThebelabToCodeCells);
        });
    }

    // Initialize Thebelab
    initFunction(initThebelab);

// Helper function to munge the language name
var detectLanguage = (language) => {
    if (language.indexOf('python') > -1) {
        language = "python";
    }
    return language;
}
</script>



  <!-- Load the auto-generating TOC (non-async otherwise the TOC won't load w/ turbolinks) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.8.1/tocbot.min.js" async></script>
  <script src="/Case-Studies-Python/assets/js/page/tocbot.js"></script>

  <!-- Google analytics -->
  


  <!-- Clipboard copy button -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script>

  <!-- Load custom website scripts -->
  <script src="/Case-Studies-Python/assets/js/scripts.js" async></script>

  <!-- Load custom user CSS and JS  -->
  <script src="/Case-Studies-Python/assets/custom/custom.js" async></script>
  <link rel="stylesheet" href="/Case-Studies-Python/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  
<script>
/**
  * To auto-embed hub URLs in interact links if given in a RESTful fashion
 */

function getJsonFromUrl(url) {
  var query = url.split('?');
  if (query.length < 2) {
    // No queries so just return false
    return false;
  }
  query = query[1];
  // Collect REST params into a dictionary
  var result = {};
  query.split("&").forEach(function(part) {
    var item = part.split("=");
    result[item[0]] = decodeURIComponent(item[1]);
  });
  return result;
}
    
function dict2param(dict) {
    params = Object.keys(dict).map(function(k) {
        return encodeURIComponent(k) + '=' + encodeURIComponent(dict[k])
    });
    return params.join('&')
}

// Parse a Binder URL, converting it to the string needed for JupyterHub
function binder2Jupyterhub(url) {
  newUrl = {};
  parts = url.split('v2/gh/')[1];
  // Grab the base repo information
  repoinfo = parts.split('?')[0];
  var [org, repo, ref] = repoinfo.split('/');
  newUrl['repo'] = ['https://github.com', org, repo].join('/');
  newUrl['branch'] = ref
  // Grab extra parameters passed
  params = getJsonFromUrl(url);
  if (params['filepath'] !== undefined) {
    newUrl['subPath'] = params['filepath']
  }
  return dict2param(newUrl);
}

// Filter out potentially unsafe characters to prevent xss
function safeUrl(url)
{
   return String(encodeURIComponent(url))
            .replace(/&/g, '&amp;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;');
}

function addParamToInternalLinks(hub) {
  var links = document.querySelectorAll("a").forEach(function(link) {
    var href = link.href;
    // If the link is an internal link...
    if (href.search("https://mark-kramer.github.io") !== -1 || href.startsWith('/') || href.search("127.0.0.1:") !== -1) {
      // Assume we're an internal link, add the hub param to it
      var params = getJsonFromUrl(href);
      if (params !== false) {
        // We have REST params, so append a new one
        params['jupyterhub'] = hub;
      } else {
        // Create the REST params
        params = {'jupyterhub': hub};
      }
      // Update the link
      var newHref = href.split('?')[0] + '?' + dict2param(params);
      link.setAttribute('href', decodeURIComponent(newHref));
    }
  });
  return false;
}


// Update interact links
function updateInteractLink() {
    // hack to make this work since it expects a ? in the URL
    rest = getJsonFromUrl("?" + location.search.substr(1));
    jupyterHubUrl = rest['jupyterhub'];
    var hubType = null;
    var hubUrl = null;
    if (jupyterHubUrl !== undefined) {
      hubType = 'jupyterhub';
      hubUrl = jupyterHubUrl;
    }

    if (hubType !== null) {
      // Sanitize the hubUrl
      hubUrl = safeUrl(hubUrl);

      // Add HTTP text if omitted
      if (hubUrl.indexOf('http') < 0) {hubUrl = 'http://' + hubUrl;}
      var interactButtons = document.querySelectorAll("button.interact-button")
      var lastButton = interactButtons[interactButtons.length-1];
      var link = lastButton.parentElement;

      // If we've already run this, skip the link updating
      if (link.nextElementSibling !== null) {
        return;
      }

      // Update the link and add context div
      var href = link.getAttribute('href');
      if (lastButton.id === 'interact-button-binder') {
        // If binder links exist, we need to re-work them for jupyterhub
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // If localhost, assume we're working from a local Jupyter server and remove `/hub`
          first = [hubUrl, 'git-sync'].join('/')
        } else {
          first = [hubUrl, 'hub', 'user-redirect', 'git-sync'].join('/')
        }
        href = first + '?' + binder2Jupyterhub(href);
      } else {
        // If interact button isn't binderhub, assume it's jupyterhub
        // If JupyterHub links, we only need to replace the hub url
        href = href.replace("", hubUrl);
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // Assume we're working from a local Jupyter server and remove `/hub`
          href = href.replace("/hub/user-redirect", "");
        }
      }
      link.setAttribute('href', decodeURIComponent(href));

      // Add text after interact link saying where we're launching
      hubUrlNoHttp = decodeURIComponent(hubUrl).replace('http://', '').replace('https://', '');
      link.insertAdjacentHTML('afterend', '<div class="interact-context">on ' + hubUrlNoHttp + '</div>');

      // Update internal links so we retain the hub url
      addParamToInternalLinks(hubUrl);
    }
}

runWhenDOMLoaded(updateInteractLink)
document.addEventListener('turbolinks:load', updateInteractLink)
</script>


  <!-- Lunr search code - will only be executed on the /search page -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.6/lunr.min.js" async></script>
  <script>var initQuery = function() {
  // See if we have a search box
  var searchInput = document.querySelector('input#lunr_search');
  if (searchInput === null) {
    return;
  }

  // Function to parse our lunr cache
  var idx = lunr(function () {
    this.field('title')
    this.field('excerpt')
    this.field('categories')
    this.field('tags')
    this.ref('id')

    this.pipeline.remove(lunr.trimmer)

    for (var item in store) {
      this.add({
        title: store[item].title,
        excerpt: store[item].excerpt,
        categories: store[item].categories,
        tags: store[item].tags,
        id: item
      })
    }
  });

  // Run search upon keyup
  searchInput.addEventListener('keyup', function () {
    var resultdiv = document.querySelector('#results');
    var query = document.querySelector("input#lunr_search").value.toLowerCase();
    var result =
      idx.query(function (q) {
        query.split(lunr.tokenizer.separator).forEach(function (term) {
          q.term(term, { boost: 100 })
          if(query.lastIndexOf(" ") != query.length-1){
            q.term(term, {  usePipeline: false, wildcard: lunr.Query.wildcard.TRAILING, boost: 10 })
          }
          if (term != ""){
            q.term(term, {  usePipeline: false, editDistance: 1, boost: 1 })
          }
        })
      });

      // Empty the results div
      while (resultdiv.firstChild) {
        resultdiv.removeChild(resultdiv.firstChild);
      }

    resultdiv.insertAdjacentHTML('afterbegin', '<p class="results__found">'+result.length+' Result(s) found</p>');
    for (var item in result) {
      var ref = result[item].ref;
      if(store[ref].teaser){
        var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<div class="archive__item-teaser">'+
                '<img src="'+store[ref].teaser+'" alt="">'+
              '</div>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      else{
    	  var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      resultdiv.insertAdjacentHTML('beforeend', searchitem);
    }
  });
};

initFunction(initQuery);
</script>

  <!-- Load JS that depends on site variables -->
  <script src="/Case-Studies-Python/assets/js/page/copy-button.js" async></script>

  <!-- Hide cell code -->
  <script src="/Case-Studies-Python/assets/js/page/hide-cell.js" async></script>

  <!-- Printing the screen -->
  <!-- Include nbinteract for interactive widgets -->
<script src="https://printjs-4de6.kxcdn.com/print.min.js" async></script>
<script>
printContent = () => {
    // MathJax displays a second version of any math for assistive devices etc.
    // This prevents double-rendering in the PDF output.
    var ignoreAssistList = [];
    assistives = document.querySelectorAll('.MathJax_Display span.MJX_Assistive_MathML').forEach((element, index) => {
        var thisId = 'MathJax-assistive-' + index.toString();
        element.setAttribute('id', thisId);
        ignoreAssistList.push(thisId)
    });

    // Print the actual content object
    printJS({
        printable: 'textbook_content',
        type: 'html',
        css: "/Case-Studies-Python/assets/css/styles.css",
        style: "#textbook_content {padding-top: 40px};",
        scanStyles: false,
        targetStyles: ["*"],
        ignoreElements: ignoreAssistList,
        documentTitle: "Made with Jupyter Book"
    })
};

initPrint = () => {
    document.querySelector('#interact-button-print').addEventListener('click', printContent)
}

initFunction(initPrint)
</script>

</head>

  <body>
    <!-- Include the ThebeLab config so it gets reloaded on each page -->
    <script type="text/x-thebe-config">{
    requestKernel: true,
    binderOptions: {
    repo: "mark-kramer/Case-Studies-Python",
    ref: "master",
    },
    codeMirrorConfig: {
    theme: "abcdef",
    mode: "python"
    },
    kernelOptions: {
    kernelName: "python3",
    path: ""
    }
}
</script>

    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <a href="https://mitpress.mit.edu/books/case-studies-neural-data-analysis" target="_blank" rel="noopener noreferrer"><img src="/Case-Studies-Python/images/logo/logo.png" class="textbook_logo" id="sidebar-logo" alt="textbook logo" data-turbolinks-permanent></a>
  <h2 class="c-sidebar__title">Case Studies in Neural Data Analysis</h2>
  <ul class="c-sidebar__chapters">
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/intro">
        <a class="c-sidebar__entry" href="/Case-Studies-Python/intro.html">
          
          Home
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      
        <li class="c-sidebar__divider">
        
      
      
        <li><h2 class="c-sidebar__title">Contents</h2></li>
        
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/01/introduction-to-python">
        <a class="c-sidebar__entry" href="/Case-Studies-Python/01/introduction-to-python.html">
          
            1.
          
          Introduction to Python
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/02/the-event-related-potential">
        <a class="c-sidebar__entry" href="/Case-Studies-Python/02/the-event-related-potential.html">
          
            2.
          
          The Event-Related Potential
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/03/the-power-spectrum-part-1">
        <a class="c-sidebar__entry" href="/Case-Studies-Python/03/the-power-spectrum-part-1.html">
          
            3.
          
          The Power Spectrum (Part 1)
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/04/ecog-rhythms">
        <a class="c-sidebar__entry" href="/Case-Studies-Python/04/ecog-rhythms.html">
          
            4.
          
          The Power Spectrum (Part 2)
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/05/the-cross-covariance-and-coherence">
        <a class="c-sidebar__entry" href="/Case-Studies-Python/05/the-cross-covariance-and-coherence.html">
          
            5.
          
          The Cross Covariance and Coherence
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/06/filtering-scalp-eeg">
        <a class="c-sidebar__entry" href="/Case-Studies-Python/06/filtering-scalp-eeg.html">
          
            6.
          
          Filtering Field Data
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/07/cross-frequency-coupling">
        <a class="c-sidebar__entry" href="/Case-Studies-Python/07/cross-frequency-coupling.html">
          
            7.
          
          Cross Frequency Coupling
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/08/basic-visualizations-and-descriptive-statistics-of-spike-train-data">
        <a class="c-sidebar__entry" href="/Case-Studies-Python/08/basic-visualizations-and-descriptive-statistics-of-spike-train-data.html">
          
            8.
          
          Basic Visualizations and Descriptive Statistics of Spike Train Data
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/09/point-process-glms">
        <a class="c-sidebar__entry" href="/Case-Studies-Python/09/point-process-glms.html">
          
            9.
          
          Modeling place Fields with Point Process Generalized Linear Models
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/10/spiking-rhythms">
        <a class="c-sidebar__entry" href="/Case-Studies-Python/10/spiking-rhythms.html">
          
            10.
          
          Analysis of Rhythmic Spiking in the Subthalamic Nucleus During a Movement Task
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/11/spike-field-coherence">
        <a class="c-sidebar__entry" href="/Case-Studies-Python/11/spike-field-coherence.html">
          
            11.
          
          Analysis of Spike-Field Coherence
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      
        <li class="c-sidebar__divider">
        
      
      
        <li><h2 class="c-sidebar__title">Appendices</h2></li>
        
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/A01/backprop">
        <a class="c-sidebar__entry" href="/Case-Studies-Python/A01/backprop.html">
          
            12.
          
          Backpropagation
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/A02/HH">
        <a class="c-sidebar__entry" href="/Case-Studies-Python/A02/HH.html">
          
            13.
          
          Hodgkin Huxley Model
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/A03/LIF">
        <a class="c-sidebar__entry" href="/Case-Studies-Python/A03/LIF.html">
          
            14.
          
          Integrate and Fire Model
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/A04/perceptron">
        <a class="c-sidebar__entry" href="/Case-Studies-Python/A04/perceptron.html">
          
            15.
          
          Training a Perceptron
        </a>
      </li>

      
      

      

      
      

      

      
    
  </ul>
  <p class="sidebar_footer">Powered by <a href="https://github.com/jupyter/jupyter-book" target="_blank" rel="noopener noreferrer">Jupyter Book</a></p>
</nav>

      
      <div class="c-topbar" id="top-navbar">
  <!-- We show the sidebar by default so we use .is-active -->
  <div class="c-topbar__buttons">
    <button id="js-sidebar-toggle" class="hamburger hamburger--arrowalt is-active">
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
    </button>
    <div class="buttons">
<div class="download-buttons-dropdown">
    <button id="dropdown-button-trigger" class="interact-button"><img src="/Case-Studies-Python/assets/images/download-solid.svg" alt="Download"></button>
    <div class="download-buttons">
        
        <a id="interact-button-print"><button id="interact-button-download" class="interact-button">.pdf</button></a>
    </div>
</div>


</div>

  </div>
  <!-- Empty sidebar placeholder that we'll auto-fill with javascript -->
  <aside class="sidebar__right">
    <header><h4 class="nav__title">
<img src="/Case-Studies-Python/assets/images/list-solid.svg" alt="Search">   On this page</h4></header>
    <nav class="onthispage">
    </nav>
  </aside>
  <a href="/Case-Studies-Python/search.html" class="topbar-right-button" id="search-button">
    <img src="/Case-Studies-Python/assets/images/search-solid.svg" alt="Search">
  </a>
</div>

      <main class="c-textbook__page" tabindex="-1">
            <div class="c-textbook__content" id="textbook_content">
              <h1 id="python-for-the-practicing-neuroscientist">Python for the practicing neuroscientist</h1>

<p>To be frank:  this notebook is rather boring.  Throughout all of the case studies, we will use the software package <a href="https://www.python.org/" target="_blank" rel="noopener noreferrer">Python</a>. The best way to learn new software (and probably most things) is when motivated by a particular problem.  Would you read assembly instructions for furniture you do not plan to own?  Probably not. In other sections we will pursue specific questions driven by neuronal data, and use our desire to understand these data to motivate the development and application of computational methods.  But not in this section.  Here, we focus on basic coding techniques and principles in Python in the abstract, without motivation.  You - poor reader - must trust that these ideas and techniques will eventually be useful.  We begin by dipping our toe into the Python pool, and learning the basic strokes;  the fun and interesting parts in the “real world” of neuronal data happen later.</p>

<p>+++</p>

<p>Let us delay no further.  In the following examples, you are asked to execute code in Python.  If your Python experience is limited, you should actually <em>do</em> this, not just read the text below.  If you intend to ignore this advice - and not execute the code in Python - then instead walk to the local coffee shop, get a double espresso, and return to attempt these examples.  This chapter follows in spirit and sometimes in detail Chapter 2 of <a href="https://www.elsevier.com/books/matlab-for-neuroscientists/wallisch/978-0-12-383836-0" target="_blank" rel="noopener noreferrer">MATLAB for Neuroscientists</a>, an excellent reference for learning to use MATLAB in neuroscience with many additional examples.  If you have never used Python before, there are many excellent resources online (e.g., the <a href="https://jakevdp.github.io/PythonDataScienceHandbook/" target="_blank" rel="noopener noreferrer">Python Data Science Handbook</a>).</p>

<p>+++</p>

<h2 id="starting-python">Starting Python</h2>

<p>There are two ways to interact with this notebook.  First, you could run it locally on your own computer using <a href="https://jupyter.org/" target="_blank" rel="noopener noreferrer">Jupyter</a>. This is an excellent choice, because you’ll be able to read, edit and excute the Python code directly and you can save any changes you make or notes that you want to record.  The second way is to open this notebook in your browser using <a href="https://mybinder.org/v2/gh/Mark-Kramer/Case-Studies-Python/master" target="_blank" rel="noopener noreferrer">Binder</a>, and execute the examples directly in your browser, without installing additional software on your computer. In any case, we encourage you to execute each line of code in this file!</p>

<p>+++</p>

<div class="python-note">

  <p>Throughout this notebook, we assume that you are running <a href="https://www.python.org/download/releases/3.0/" target="_blank" rel="noopener noreferrer">Python 3</a>. Most of the functions used here are the same in Python 2 and 3. One noteable exception however is division. If you are using Python 2, you will find that the division operator <code class="language-plaintext highlighter-rouge">/</code> actually computes the <em>floor</em> of the division if both operands are integers (i.e., no decimal points). For example, in Python 2, <code class="language-plaintext highlighter-rouge">4/3</code> equals <code class="language-plaintext highlighter-rouge">1</code>. While, in Python 3, <code class="language-plaintext highlighter-rouge">4/3</code> equals <code class="language-plaintext highlighter-rouge">1.333</code>.</p>

  <p>We encourage you to use Python 3 for the sake of compatibility with this notebook, as well as for compatibility with future releases of Python.</p>

</div>

<p>+++</p>

<h2 id="on-ramp-analysis-of-neural-data-in-python">On-ramp: analysis of neural data in Python</h2>
<p>We begin this module with an “<em>on-ramp</em>” to analysis in Python. The purpose of this on-ramp is to introduce you immediately to some aspects of Python. You may not understand all aspects of the Python language here, but that’s not the point. Instead, the purpose of this on-ramp is to  illustrate what <em>can</em> be done. Our advice is to simply run the code below and see what happens…</p>

<p>```{code-cell} ipython3
import scipy.io as sio               # Import packages to read data, do analysis, and plot it.
import numpy as np
%matplotlib inline
import matplotlib.pyplot as plt</p>

<p>mat = sio.loadmat(‘sample_data.mat’) # Load the example data set.
t   = mat[‘t’][0]                    # Get the values associated with the key ‘t’ from the dictorary.
LFP = mat[‘LFP’][0]                  # Get the values associated with the key ‘LFP’ from the dictorary</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                                 # Print useful information about the data. print("Sampling frequency is " + str( 1/(t[2]-t[1]))  + ' Hz.') print("Total duration of recording is " + str(t[-1]) + ' s.') print("Dimensions of data are " + str(np.shape(LFP)) + ' data points.')
</code></pre></div></div>

<p>initial_time_interval = t &lt; 5        # Choose an initial interval of time, from onset to 5 s,
                                     # … and plot it.
plt.plot(t[initial_time_interval], LFP[initial_time_interval])
plt.xlabel(‘Time [s]’)
plt.ylabel(‘LFP’)
plt.title(‘Initial interval of LFP data’);</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
&lt;div class="question"&gt;

**Q:** Try to read the code above. Can you see how it loads data, extracts useful information to print, then selects an interval of data to plot?

**A:** If you've never used Python before, that's an especially difficult question. Please continue on to learn more!

&lt;/div&gt;

+++

## Example 1: Python is a calculator

Execute the following commands in Python:

```{code-cell} ipython3
4+9
</code></pre></div></div>

<p>```{code-cell} ipython3
4/3</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
&lt;div class="question"&gt;

**Q:**  What does Python return?  Does it make sense?

&lt;/div&gt;

+++

## Example 2.  Python can compute complicated quantities.

Enter the following command in Python:

```{code-cell} ipython3
4/10**2
</code></pre></div></div>

<div class="question">

  <p><strong>Q:</strong> Does this answer make sense?</p>

</div>

<p>+++</p>

<div class="question">

  <p><strong>Q:</strong> Can you use parentheses to change the answer?</p>

</div>

<p>+++</p>

<h2 id="example-3--python-has-useful-built-in-functions">Example 3.  Python has useful built in functions.</h2>

<p>A function is a program that operates on arguments. Standard math functions and variables (and other useful things) can be accessed from the <code class="language-plaintext highlighter-rouge">math</code> and <code class="language-plaintext highlighter-rouge">numpy</code> modules. To use the <code class="language-plaintext highlighter-rouge">math</code> and <code class="language-plaintext highlighter-rouge">numpy</code> modules, we must first import both:</p>

<p>```{code-cell} ipython3
import numpy as np
import math</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
You will often begin your data analysis with `import` statements, to load the functionality you need. We can now call functions from math using `numpy.*`.  For example,

```{code-cell} ipython3
np.sin(2*np.pi)
</code></pre></div></div>

<p>Above, <code class="language-plaintext highlighter-rouge">np.sin</code> is the sine function.  It operates on the argument <code class="language-plaintext highlighter-rouge">2*np.pi</code>.  Notice that, once we have imported the <code class="language-plaintext highlighter-rouge">numpy</code> module, Python knows the value of <code class="language-plaintext highlighter-rouge">np.pi</code>. Here’s another example function that operates on arguments:</p>

<p>```{code-cell} ipython3
math.atan(2*np.pi)</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
&lt;div class="question"&gt;

**Q:**  What is `math.atan`?

**A:** To answer this, try using Python Help.  To start the Python Help, simply put a `?` at the end of `math.atan` and then run this code block. 

&lt;/div&gt;

```{code-cell} ipython3
math.atan?
</code></pre></div></div>

<p>You should see a description of the function pop up at the bottom of the window.</p>

<p><strong>NOTE:</strong>  Python Help is <em>extremely</em> useful.  You can always look there when you have questions about a function, or search the internet for help, i.e., <a href="http://www.google.com" target="_blank" rel="noopener noreferrer">google it</a>.</p>

<p>+++</p>

<h2 id="example-4--we-can-use-python-to-define-lists-of-numbers">Example 4.  We can use Python to define lists of numbers.</h2>

<p>In Python, there are several different data structures that are designed to store more than one element. Here we will focus on the <code class="language-plaintext highlighter-rouge">array</code> data structure, but if you are curious to know how and when to use other structures, there is a good explanation <a href="http://www.physics.nyu.edu/pine/pymanual/html/chap3/chap3_arrays.html" target="_blank" rel="noopener noreferrer">here</a>. Let’s define an array:</p>

<p>```{code-cell} ipython3
a = np.array([[1, 2, 3, 4]])</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
##  Example 5.  We can manipulate arrays by scalars.

A scalar is a single number.  Consider,

```{code-cell} ipython3
a = np.array( [[1, 2, 3, 4]] )
print( a * 3 )
print( 4 * a )
print( a + 1 )
</code></pre></div></div>

<div class="question">

  <p><strong>Q:</strong> What do you find?</p>

  <p><strong>A:</strong> Notice that the scalar operates on each element of the array.</p>

</div>

<p>+++</p>

<h2 id="example-6--we-can-manipulate-arrays-with-arrays">Example 6.  We can manipulate arrays with arrays.</h2>

<p>Let’s create an array and multiply it by itself,</p>

<p>```{code-cell} ipython3
a = np.array([1,2,3,4])
a * a</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
&lt;div class="question"&gt;

**Q:**  What does this return?

**A:** We see that the operator `*` performs element-by-element multiplication of the values in array `a`.

&lt;/div&gt;

+++

## Example 7. More examples of manipulating arrays with arrays.

```{code-cell} ipython3
a = 2
b = np.array( [[0, 4, 7, 6]] )
c = np.array( [[1, 5, 6, 8]] )

print( b * c )
print( b / c + a)
print( np.multiply( b, c ))
</code></pre></div></div>

<div class="question">

  <p><strong>Q:</strong> What operation does <code class="language-plaintext highlighter-rouge">np.multiply()</code> perform?</p>

</div>

<p>+++</p>

<h2 id="example-8--we-can-probe-the-variables-weve-defined-in-python">Example 8.  We can probe the variables we’ve defined in Python.</h2>

<p>To see a list of the variables you’ve defined, type <code class="language-plaintext highlighter-rouge">who</code> or <code class="language-plaintext highlighter-rouge">whos</code> in a code block by themselves. Notice <code class="language-plaintext highlighter-rouge">whos</code> provides more information.</p>

<p>```{code-cell} ipython3
who</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
```{code-cell} ipython3
whos
</code></pre></div></div>

<h2 id="example-9--determine-the-dimensions-of-an-array">Example 9.  Determine the dimensions of an array</h2>

<p>To examine the dimensions of an array, we can ask for the <code class="language-plaintext highlighter-rouge">shape</code>,</p>

<p>```{code-cell} ipython3
a = np.array([[1,2,3,4]])
print(a.shape)
print(np.shape(a))</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
We find that the shape of `a` is `(1,4)` or 1 row and 4 columns. Notice we have two options to execute the `shape` function:

- In `a.shape` we return the attribute `shape` of the variable `a`. 

- In `np.shape(a)` we apply the function `np.shape` to the variable `a`.

The result is equivalent.

+++

## Example 10. Sometimes we need to reset the workspace

By doing so, we get rid of all the variables. To do so, type `%reset` and enter `y`

```{code-cell} ipython3
%reset
</code></pre></div></div>

<div class="question">

  <p><strong>Q.</strong> What command could we use to confirm there are no variables in the workspace?</p>

  <p><strong>A.</strong> Consider <code class="language-plaintext highlighter-rouge">who</code>.</p>

</div>

<p>```{code-cell} ipython3
who</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
&lt;div class="python-note"&gt;
    
The `%reset` command is an example of a *magic*. Magics are commands that start with the `%` symbol and use a language other than Python. They are only available in the notebook environment. In fact, the set of magics that is available is specific to the notebook kernel. This means that if you have a Jupyter notebook running a Ruby kernel the magics will be different.

&lt;/div&gt;

+++

##  Example 11.  We can define matrices in Python.
A matrix is an array with more than one dimensio.  Consider the following:

```{code-cell} ipython3
import numpy as np  # Have to reimport as we cleared the workspace above!

p = np.array( [[1,2,3],[4,5,6]] )
</code></pre></div></div>

<p>This creates a matrix with two rows and three columns. Consider,</p>

<p>```{code-cell} ipython3
print( p )</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
&lt;div class="question"&gt;

**Q:** Can you see the two rows and three columns?

&lt;/div&gt;

We can manipulate matrices like we manipulate vectors.

```{code-cell} ipython3
print( p + 2 )
print( 2 * p )
print( p * p )
</code></pre></div></div>

<h2 id="example-12--indexing-matrices-and-vectors">Example 12.  Indexing matrices and vectors.</h2>
<p>Matrices and vectors are arrays of numbers, and sometimes we want to
access individual elements or small subsets of these lists.  That’s
easy to do in Python.  Consider,</p>

<p>```{code-cell} ipython3
a = np.array( [1, 2, 3, 4, 5] )
b = np.array( [6, 7, 8, 9, 10] )</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
 Python indexes from 0 (like C, C++, Java, and unlike MATLAB and Fortran which start at 1). 
 To access the 2nd element of `a` or `b`, type `a[1] / b[1]`.
 We'll be a bit fancier with our printing now to distinguish variables. 
 Calling `str(a)` converts the variable `a` to a string that can be printed easily.
 Adding two strings just concatenates them: `"hi" + " bye" = "hi bye". `

```{code-cell} ipython3
print( "a[1] = " + str(a[1]) )
print( "b[1] = " + str(b[1]) )
</code></pre></div></div>

<div class="question">

  <p><strong>Q.</strong>  Do the results make sense?  How would you access the 4th element of each vector?</p>

</div>

<p>+++</p>

<p>We can combine <code class="language-plaintext highlighter-rouge">a</code> and <code class="language-plaintext highlighter-rouge">b</code> to form a matrix with <code class="language-plaintext highlighter-rouge">a</code> as the first row and <code class="language-plaintext highlighter-rouge">b</code> as the second.
  Note that we apply the function <code class="language-plaintext highlighter-rouge">np.array()</code> to the <em>list</em> <code class="language-plaintext highlighter-rouge">[a,b]</code>, which it converts to a matrix.</p>

<p>```{code-cell} ipython3
c = np.array([a,b])
print( “c = \n” + str(c) )    # \n is a newline, or carriage return, which makes the printed matrix lineup better</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
  To learn the size (or shape)
 of `c` we use `np.shape()`:

```{code-cell} ipython3
print( "shape of c = " + str( np.shape(c) ) )
</code></pre></div></div>

<p>The shape of <code class="language-plaintext highlighter-rouge">c</code> is <code class="language-plaintext highlighter-rouge">[2 5]</code>.  It has two rows and five columns.  To access
  the individual element in the 1st row and 4th column of <code class="language-plaintext highlighter-rouge">c</code>, type <code class="language-plaintext highlighter-rouge">c[0,3]</code></p>

<p>```{code-cell} ipython3
print( “c[0,3] = “ + str( c[0,3] ) )</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
&lt;div class="python-note"&gt;
    
We access matrices using 'row, column' notation.  So `c[0,3]` means
print the element in row 0, column 3 of `c`.

&lt;/div&gt;

+++

&lt;div class="question"&gt;

**Q.**  How would you print all rows in the 2nd column of `c`?

&lt;/div&gt;

+++

##  Example 13:  We can find subsets of elements in matrices and vectors.
Often we are interested in only some of the elements of a matrix or vector. For example, we might want to look at the data from a single experimental trial which is stored in a particular row of a matrix. Alternatively, we might want to find out when the values in a time series cross a given boundary. Doing this is simple in Python.

+++

### Slicing
*Slicing* means that we want to look at a specific portion of a vector or matrix, for example, the first row of a matrix. We will continue with the matrix `c` from the previous example. The notation '`:`' means '*all indices*'. To access all columns in the entire first row of `c`, type `c[0,:]`. To access the 2nd thru 4th columns of the first row of `c`, type `c[0,1:4]`.

```{code-cell} ipython3
print( "c[0,:] = " + str( c[0,:] ) )
print( "2nd through 4th columns of the first row are c[0,1:4] = " + str(c[0,1:4]) )
</code></pre></div></div>

<div class="python-note">

  <p>The notation <code class="language-plaintext highlighter-rouge">1:4</code> means <em>all integers from 1 up to, but not including 4</em>, 
  which in this case gives columns 1, 2, and 3.</p>

</div>

<p>+++</p>

<p>Leaving out the number before the colon tells Python to start at index 0. Leaving out the number after the colon tells Python to continue all the way to the end.</p>

<p>```{code-cell} ipython3
print(“c[0, :4] = “ + str( c[0,:4]))
print(“c[0, 1:] = “ + str( c[0,1:]))</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
We can also tell Python how to step through the indices. To access only the even columns of `c`, we can use the following:

```{code-cell} ipython3
c[0,::2]
</code></pre></div></div>

<p>This code tells Python to start at 0, continue to the end, and step by 2. The result should be the values in row 0, columns 0, 2, and 4 of <code class="language-plaintext highlighter-rouge">c</code>. We could write this explicitly as <code class="language-plaintext highlighter-rouge">c[0,0:5:2]</code>.</p>

<p>+++</p>

<p>### Selecting elements that satisfy a condition
  Sometimes we’re interested in locating particular values within a
  matrix or vector.  As an example, let’s first define a vector.</p>

<p>```{code-cell} ipython3
a = np.arange(1,10)    # this creates a vector of increasing values from 1 to 9
a = 2*a</p>

<p>print( “a = “ + str(a) )</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
&lt;div class="question"&gt;

**Q.**  Calculate the shape of `a`.  What is the maximum value of `a`? 
*Hint:* Use the `np.max()` function.

&lt;/div&gt;

+++

  Now let's find all values in `a` that exceed 10.

```{code-cell} ipython3
a[a &gt; 10]
</code></pre></div></div>

<p>This is called logical indexing, let’s look at what <code class="language-plaintext highlighter-rouge">a&gt;10</code> returns:</p>

<p>```{code-cell} ipython3
lgIdx = a &gt; 10
lgIdx</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
When we index `a` using this array `lgIdx` we get back only the entries 
in `a` corresponding to `True`, as above:

```{code-cell} ipython3
a[lgIdx]
</code></pre></div></div>

<p>Sometimes we want to know the actual indices in a where <code class="language-plaintext highlighter-rouge">a &gt; 10</code>.
We can get them using the <code class="language-plaintext highlighter-rouge">nonzero()</code> array method, which returns the
index of all entries that were <code class="language-plaintext highlighter-rouge">True</code>, or non-zero.</p>

<p>```{code-cell} ipython3
lgIdx.nonzero()</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
&lt;div class="python-note"&gt;
    
The command `nonzero()` can be used as both a *function* and a *method*. A method is called by adding it after the object it is meant to operate on with a period in between ( `lgIdx.nonzero()` ). A function is called with the *argument* explicitly provided inside the parentheses ( `np.nonzero(lgIdx)` ). Basically, a function and a method do the same thing, but a function needs to be given an argument, while a method assumes that the argument is the object that the method is attached to. Note that if we use `nonzero()` as a function, we need to tell it to look in NumPy for the definition (i.e. add `np.` at the beginning of the function call). 

&lt;/div&gt;

+++

Now we have another way to select the desired elements of `a`:

```{code-cell} ipython3
a[ (a &gt; 10).nonzero() ]
</code></pre></div></div>

<p>We can use these two types of indexing to change subsets of the values of <code class="language-plaintext highlighter-rouge">a</code>.</p>

<p>```{code-cell} ipython3
print(“a = “ + str(a))
a[a &gt; 10] = 100
print(“a = “ + str(a))</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
**Q:** How does `a` change in the first and second print statements?

We can perform these same logical operations for a matrix,

```{code-cell} ipython3
b = np.array([[1,2,3],[4,5,6],[7,8,9]])
print( "b = \n" + str(b) )
print( " b &gt; 5 is \n" + str(b &gt; 5) )
print(" b[b&gt;5] is an array: " + str(b[b&gt;5]) )
</code></pre></div></div>

<div class="python-note">

  <p>Notice that the last line collapses the <code class="language-plaintext highlighter-rouge">True</code> entries to an array, 
ordered by row and then by column. If you’ve used MATLAB, this is 
the opposite of what it does!</p>

</div>

<p>+++</p>

<h2 id="example-14--plotting-data-in-python">Example 14:  Plotting data in Python.</h2>
<p>It’s not easy to look at lists of numbers and gain an intuitive
feeling for their behavior, especially when the lists are long.  In
these cases, it’s better to visualize the lists of numbers by
plotting them.  Consider</p>

<p>```{code-cell} ipython3
x = np.linspace(0,10,11) <br>
print( “x = “ + str(x) )</p>

<h1 id="the-above-line-constructs-a-vector-that-starts-at-0-ends-at-10-and">The above line constructs a vector that starts at 0, ends at 10, and</h1>
<h1 id="has-11-entries-takes-steps-of-size-1-from-0-to-10-let">has 11 entries (takes steps of size 1 from 0 to 10). Let</h1>

<p>y = np.sin(x)
print( “y = “ + str(y) )</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
&lt;div class="question"&gt;

**Q.** Looking at the values in 'y' printed above, can you tell what's happending?

**A.** Not really ... let's visualize `y` vs `x` instead.

&lt;/div&gt;

+++

### matplotlib
To visualize `y` versus `x` let's plot it. To do so, let's first import some basic plotting routines from `matplotlib`, which provides a nice [2D plotting library](https://matplotlib.org/). We'll also tell Python to show  `matplotlib` graphics inline, in this notebook.

Let's start by plotting a simple example for `x` and `y`,

```{code-cell} ipython3
%matplotlib inline
import matplotlib.pyplot as plt

x = ([1, 2, 3, 4])
y = x
plt.plot(x,y) 
plt.show()          # this is the plotting equivalent of print()
</code></pre></div></div>

<div class="question">

  <p><strong>Q.</strong> Does the plot above make sense for the variables <code class="language-plaintext highlighter-rouge">x</code> and <code class="language-plaintext highlighter-rouge">y</code>?</p>

</div>

<p>Now, let’s go back to the definitions of <code class="language-plaintext highlighter-rouge">x</code> and <code class="language-plaintext highlighter-rouge">y</code> that we started this example with and plot <code class="language-plaintext highlighter-rouge">y</code> versus <code class="language-plaintext highlighter-rouge">x</code>.</p>

<p>```{code-cell} ipython3
x = np.linspace(0,10,11) <br>
y = np.sin(x)</p>

<p>plt.plot(x, y)
plt.show()</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
 The plot of `x` versus `y` should look a bit jagged, and not 
 smooth like a sinusoid.  To make the curve smoother,
 let's redefine `x` as,

```{code-cell} ipython3
x = np.linspace(0,10, 101)
print(x)
</code></pre></div></div>

<div class="question">

  <p><strong>Q.</strong>  Compare this definition of <code class="language-plaintext highlighter-rouge">x</code> to the definition above.  How do these
two definitions differ?</p>

</div>

<p>+++</p>

<div class="question">

  <p><strong>Q.</strong>  What is the size of <code class="language-plaintext highlighter-rouge">x</code>?  Does this make sense?</p>

</div>

<p>+++</p>

<p>Now let’s replot the sine function.</p>

<p>```{code-cell} ipython3
y = np.sin(x)
plt.plot(x,y,’k’)   # the ‘k’ we’ve added makes the curve black instead of blue
plt.show()</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
&lt;div class="question"&gt;

**Q.** Does this plot make sense, given your knowledge of `x`, `y`, and trigonometry?

&lt;/div&gt;

+++

## Example 15: What if we want to compare several functions?

+++

Continuing the example in the previous section, let’s define a second vector

```{code-cell} ipython3
z = np.cos(x)
</code></pre></div></div>

<p>and plot it:</p>

<p>```{code-cell} ipython3
plt.plot(x,z)
plt.show()</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
We’d now like to compare the two variables `y` and `z`. To do this, let’s plot both vectors on
the same figure, label the axes, and provide a legend,

```{code-cell} ipython3
plt.plot(x,z)                     # plot z vs x.
plt.plot(x,y,'r')                 # plot y vs x in red
plt.show()
</code></pre></div></div>

<p>Notice that we’ve included a third input to the function <code class="language-plaintext highlighter-rouge">plt.plot</code>. Here the third input tells Python to draw the curve in a particular color: <code class="language-plaintext highlighter-rouge">'r'</code> for red. There are many options we can use to plot; to see more, check out the documentation for <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html" target="_blank" rel="noopener noreferrer">plot</a>.</p>

<p>We can also label the axes, give the figure a title, and provide a legend,</p>

<p>```{code-cell} ipython3
plt.plot(x,z)                     # plot z vs x
plt.plot(x,y,’r’)                 # plot y vs x in red
plt.xlabel(‘x’)                   # x-axis label
plt.ylabel(‘y or z’)              # y-axis label
plt.title(‘y vs x and z vs x’)    # title
plt.legend((‘y’,’z’))             # make a legend labeling each line
plt.show()</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
To futher edit this plot, you might decide - for example - that the font size for the labels is too small. We can change the default with:

```{code-cell} ipython3
import matplotlib as mpl # we need to import the functions that will do this

mpl.rcParams.update({'font.size': 12})  
mpl.rcParams['axes.labelsize']=14      # make the xlabel/ylabel sizes a bit bigger to match up better

# we can change the default linewidth with
mpl.rcParams['lines.linewidth']=2

# let's make a new plot to check 
plt.plot(x,y, label='y')     # sometimes it is easier to name a trace within the plot() call
plt.plot(x,z, label='z')     # notice without a color matplotlib will assign one
plt.xlabel('x')
plt.ylabel('y')
plt.title('y vs x')
plt.legend()
plt.show()
</code></pre></div></div>

<h2 id="example-16--we-can-make-random-numbers-in-python">Example 16:  We can make random numbers in Python.</h2>
<p>To generate a single Gaussian random number in Python, use the function in the NumPy <code class="language-plaintext highlighter-rouge">random</code> module.</p>

<p>```{code-cell} ipython3
print(“a Gaussian random number (mean=0, variance=1): “ + str( np.random.randn() ))</p>

<h1 id="a-uniform-random-number-on-01">a uniform random number on [0,1)</h1>
<p>print(“a uniform random number from [0,1): “ + str(np.random.rand()))</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Let's generate a vector of 1000 Gaussian random numbers:

```{code-cell} ipython3
r = np.random.randn(1000)
</code></pre></div></div>

<p>… and look at a histogram of the vector:</p>

<p>```{code-cell} ipython3
plt.hist(r)
plt.show()</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
&lt;div class="question"&gt;

**Q.** Does this histogram make sense? Is it what you expect for a distribution of Gaussian random variables?

&lt;/div&gt;

+++

&lt;div class="python-note"&gt;
    
See Python Help (`plt.hist?`) to learn about the function `hist()`.

&lt;/div&gt;

+++

##  Example 17:  Repeating commands over and over and over . . . 
  Sometimes we'll want to repeat the same command over and over again.
  For example, what if we want to plot `sin(x + k*pi/4)` where `k` varies from 1 to 5 in
  steps of 1;  how do we do it?  Consider the following:

```{code-cell} ipython3
x = np.arange(0,10,0.1)  # Define a vector x that ranges from 0 to 9.9 with step 0.1.
k = 1                    # Fix k=1,
y = np.sin(x + k*np.pi/4)# ... and define y at this k.

plt.figure()             # Make a new figure,
plt.plot(x,y)            # ... and plot y versus x.

k = 2                    # Let's repeat this, for k=2,
y = np.sin(x + k*np.pi/4)# ... and redefine y at this k,
plt.plot(x,y)            # ... and plot it.

k = 3                    # Let's repeat this, for k=3,
y = np.sin(x + k*np.pi/4)# ... and redefine y at this k,
plt.plot(x,y)            # ... and plot it.

k = 4                    # Let's repeat this, for k=4,
y = np.sin(x + k*np.pi/4)# ... and redefine y at this k,
plt.plot(x,y)            # ... and plot it.

k = 5                    # Let's repeat this, for k=5,
y = np.sin(x + k*np.pi/4)# ... and redefine y at this k,
plt.plot(x,y)            # ... and plot it.

plt.show()
</code></pre></div></div>

<p>That’s horrible code!  All I did was cut and paste the same thing four times.  As a general rule, if you’re repeatedly cutting and pasting in code, what you’re doing is inefficient and typically error prone.  There’s a much more elegant way to do this, and it involves making a <code class="language-plaintext highlighter-rouge">for</code> loop.  Consider:</p>

<p>```{code-cell} ipython3
x = np.arange(0,10,0.1)        #First, define the vector x.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Now let's declare a `for` loop where `k` successively takes the values 1, then 2, then 3, ..., up to 5. Note, any code we want to execute as part of the loop must be indented one level. The first line of code that is not indented, in this case `plt.show()` below, executes after the for loop completes

```{code-cell} ipython3
for k in range(1,6):               
    y = np.sin(x + k*np.pi/4)      #Define y (note the variable 'k' in sin), also note we have indented here!
    plt.plot(x,y)                  #Plot y versus x
    
# no indentation now, so this code follows the loop
plt.show() 
</code></pre></div></div>

<p>The small section of code above replaces all the cutting-and-pasting.
  Instead of cutting and pasting, we update the definition of <code class="language-plaintext highlighter-rouge">y</code> with different values of <code class="language-plaintext highlighter-rouge">k</code> and plot it within this for-loop.</p>

<div class="question">

  <p><strong>Q.</strong>  Spend some time studying this for-loop.  Does it make sense?</p>

</div>

<p>+++</p>

<div class="python-note">

  <p><strong>Important note:</strong> Python uses <strong>indentation</strong> to define <code class="language-plaintext highlighter-rouge">for</code> loops.</p>

</div>

<p>+++</p>

<h2 id="example-18--defining-a-new-function">Example 18:  Defining a new function.</h2>
<p>We’ve spent some time in this notebook writing and executing code. Sometimes we’ll need to write our own Python functions.  Let’s do that now.</p>

<p>Our function will do something very simple: it will take as input a
vector and return as output the vector elements squared plus an additive
constant.</p>

<p>If have a vector, <code class="language-plaintext highlighter-rouge">v</code>, and a constant, <code class="language-plaintext highlighter-rouge">b</code>, we would like to call:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vsq = my_square_function(v, b)
</code></pre></div></div>

<p>This won’t work!  We first need to define <code class="language-plaintext highlighter-rouge">my_square_function</code>. Let’s do so now,</p>

<p>```{code-cell} ipython3
def my_square_function(x, c):
    “"”Square a vector and add a constant.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Arguments:
x -- vector to square
c -- constant to add to the square of x

Returns:
x*x + c
"""

return x * x + c     ```
</code></pre></div></div>

<p>The function begins with the keyword <code class="language-plaintext highlighter-rouge">def</code> followed by the function name and the inputs in parentheses. Notice that this first line ends with a colon <code class="language-plaintext highlighter-rouge">:</code>. All of the function components that follow this first line should be <strong>indented one level</strong>. This is just like the <code class="language-plaintext highlighter-rouge">for</code> loop we applied earlier; the operations performed by the for loop were indented one leve.</p>

<p>+++</p>

<div class="python-note">

  <p>When defining the function, the code the function executes should be indented one level.</p>

</div>

<p>+++</p>

<p>The text inside triple quotes provides an optional documentation string that describes our function. While optional, including a ‘<em>doc string</em>’ is an important part of making your code understandable and reuseable.</p>

<p>The keyword <code class="language-plaintext highlighter-rouge">return</code> exits the function, and in this case returns the expression <code class="language-plaintext highlighter-rouge">x * x + c</code>. Note that a return statement with no arguments returns <code class="language-plaintext highlighter-rouge">None</code>, indicating the absence of a value.</p>

<p>With the function defined, let’s now call it. To do so we first define the inputs, and then run the function, as follows:</p>

<p>```{code-cell} ipython3
v = np.linspace(0.,10.,11)
b = 2.5</p>

<h1 id="now-lets-run-the-code">Now let’s run the code,</h1>
<p>v2 = my_square_function(v, b)
print(“v = “ + str(v))
print(“v*v+2.5 = “ + str(v2))</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
To see the doc string that describes our function, type `my_square_function?`

```{code-cell} ipython3
# Let's check that our docstring works
my_square_function?
</code></pre></div></div>

<div class="question">

  <p><strong>Q.</strong> Try to make a function, my_power, so that 
<code class="language-plaintext highlighter-rouge">y = power(x,n)</code> evaluates $y = x^n$, 
(in Python you can use <code class="language-plaintext highlighter-rouge">x**n</code> to take the power)</p>

</div>

<p>+++</p>

<div class="question">

  <p><strong>Q.</strong> Try to make a function, my_power, so that 
<code class="language-plaintext highlighter-rouge">y = power(x,n)</code> evaluates $y = x^n$, 
(in Python you can use <code class="language-plaintext highlighter-rouge">x**n</code> to take the power)</p>

</div>

<p>+++</p>

<h2 id="example-19-animating-figures">Example 19: Animating figures</h2>
<p>Finally, let’s make an animation in Python. To do this we need two additional functions from external modules: <code class="language-plaintext highlighter-rouge">HTML()</code> and <code class="language-plaintext highlighter-rouge">FuncAnimation()</code>. <code class="language-plaintext highlighter-rouge">FuncAnimation</code> is what creates the animated figure, while <code class="language-plaintext highlighter-rouge">HTML</code> tells the notebook that to interpret the argument as HTML and show the results.</p>

<p>```{code-cell} ipython3
from IPython.display import HTML
from matplotlib.animation import FuncAnimation</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
In English, we set up (or initialize) the figure and then make a function that does all of the updates for each frame of the animation. Finally, we pass the figure, the function, and the frame numbers to `FuncAnimation()` and we have our animation.

Here's an example in which we plot a sinusoid of different heights, and allow the user to adjust the heights with a slider.

```{code-cell} ipython3
x = np.linspace(0.,2.,1001)                 # Define x from 0 to 2 with 1001 steps.
lines = plt.plot(x, 0. * np.sin(x*np.pi))   # Make the first plot, save the curve in "lines"
plt.axis([0, 2, -1, 1])                     # Set the x and y limits in the plot
plt.title("plot number = 0")                # ... and label the plot.

def animate(frame):                         # Define the function to perform the animation.
    lines[0].set_ydata(float(frame) / 100. * np.sin(x * np.pi)) # Change the y values at each x location
    plt.title('plot number = ' + str(frame))# Update the title with the new plot number
    
fig = FuncAnimation(plt.gcf(), animate, frames=range(100))
HTML(fig.to_jshtml())
</code></pre></div></div>

<h2 id="example-19-load-matlab-data-into-python">Example 19: Load MATLAB data into Python</h2>
<p>For our last example let’s load a MATLAB file in the <code class="language-plaintext highlighter-rouge">.mat</code> format into Python. Before doing so, let’s clear all of the variables and functions we have defined. This command is not necessary, but we perform it here so that any new variables we subsequently load are obvious.</p>

<p>```{code-cell} ipython3
%reset</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Then, let's import the `scipy.io` module, which we'll use to import the `.mat` data,

```{code-cell} ipython3
import scipy.io as sio
</code></pre></div></div>

<p>Now, let’s load a data file using the function <code class="language-plaintext highlighter-rouge">loadmat</code>,</p>

<p>```{code-cell} ipython3
mat = sio.loadmat(‘sample_data.mat’)
type(mat)</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
The variable that holds the loaded data is a dictionary. In Python, a dictionary is like a list, with the elements of the dictionary accessed via “keys”. Let's print these keys:

```{code-cell} ipython3
print(mat.keys())
</code></pre></div></div>

<div class="python-note">

  <p>Use the <code class="language-plaintext highlighter-rouge">keys()</code> method to see what variables are contained in <code class="language-plaintext highlighter-rouge">mat</code>. In other words, run the command <code class="language-plaintext highlighter-rouge">mat.keys()</code>.</p>

</div>

<p>+++</p>

<p>The two keys of interest to us are <code class="language-plaintext highlighter-rouge">t</code> and <code class="language-plaintext highlighter-rouge">LFP</code>. Our collaborator who provided the data tells us that these correspond to a time axis (<code class="language-plaintext highlighter-rouge">t</code>) and voltage recording (<code class="language-plaintext highlighter-rouge">LFP</code>), respectively, for her data. Let’s define variables to hold the data corresponding to each key,</p>

<p>```{code-cell} ipython3
t = mat[‘t’][0]                      # Get the values associated with the key ‘t’ from the dictorary.
LFP = mat[‘LFP’][0]                  # Get the values associated with the key ‘LFP’ from the dictorary</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Now, let's plot the LFP data versus the time axis,

```{code-cell} ipython3
%matplotlib inline
import matplotlib.pyplot as plt

# Choose a subset to plot
t = t[0:500]
LFP = LFP[0:500]

plt.plot(t, LFP)
plt.title('My plot')
plt.xlabel('Time [s]')
plt.ylabel('Voltage [$\mu$ V]') # Wrap latex characters in $..$
plt.show()
</code></pre></div></div>

            </div>
            <div class="c-textbook__footer" id="textbook_footer">
              
<nav class="c-page__nav">
  

  
</nav>

              <footer>
  <p class="footer">This page was created by <a href="https://github.com/jupyter/jupyter-book/graphs/contributors" target="_blank" rel="noopener noreferrer">The Jupyter Book Community</a></p>
</footer>

            </div>

        </main>
</div>
      
    
  </body>
</html>
