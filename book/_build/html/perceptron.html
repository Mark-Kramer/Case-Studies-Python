

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Training a Perceptron &#8212; Case Studies in Neural Data Analysis</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/mystnb.js"></script>
    <script src="_static/custom.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="canonical" href="https://mark-kramer.github.io/Case-Studies-Python/perceptron.html" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="The integrate and fire neuron" href="LIF.html" />


    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
<!-- Put requirejs at the end so it's always after bootstrap -->
<!-- TODO: remove this once https://github.com/pandas-dev/pydata-sphinx-theme/pull/149 is merged -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>


<!-- Opengraph tags -->
<meta property="og:url"         content="https://mark-kramer.github.io/Case-Studies-Python/perceptron.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Training a Perceptron" />
<meta property="og:description" content="Training a Perceptron  In this module, we will construct simple perceptron models. We’ll start by implementing a perceptron model, and seeing how it behaves. We" />
<meta property="og:image"       content="https://mark-kramer.github.io/Case-Studies-Python/_static/logo.png" />

<meta name="twitter:card" content="summary">


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          

<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Case Studies in Neural Data Analysis</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
  <li class="">
    <a href="intro.html">Case-Studies-Python</a>
  </li>
  <li class="">
    <a href="introduction-to-python.html">Python for the practicing neuroscientist</a>
  </li>
  <li class="">
    <a href="the-event-related-potential.html">The Event-Related Potential for the practicing neuroscientist</a>
  </li>
  <li class="">
    <a href="the-power-spectrum-part-1.html">Analysis of rhythmic activity for the practicing neuroscientist</a>
  </li>
  <li class="">
    <a href="ecog-rhythms.html">The Power Spectrum (Part 2)</a>
  </li>
  <li class="">
    <a href="the-cross-covariance-and-coherence.html">Analysis of coupled rhythms for the practicing neuroscientist</a>
  </li>
  <li class="">
    <a href="filtering-scalp-eeg.html">Application of Filtering to Scalp EEG Data</a>
  </li>
  <li class="">
    <a href="cross-frequency-coupling.html">Cross-frequency coupling for the practicing neuroscientist</a>
  </li>
  <li class="">
    <a href="basic-visualizations-and-descriptive-statistics-of-spike-train-data.html">Basic Visualizations and Descriptive Statistics of Spike Train Data</a>
  </li>
  <li class="">
    <a href="point-process-glms.html">Modeling Place Fields with Point Process Generalized Linear Models</a>
  </li>
  <li class="">
    <a href="spiking-rhythms.html">Analysis of Rhythmic Spiking in the Subthalamic Nucleus During a Movement Task</a>
  </li>
  <li class="">
    <a href="spike-field-coherence.html">Analysis of spike-field cohernece for the practicing neuroscientist <a id="top"></a></a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Appendices</p>
</li>
  <li class="">
    <a href="backprop.html">Backpropagation</a>
  </li>
  <li class="">
    <a href="HH.html">The Hodgkin-Huxley model</a>
  </li>
  <li class="">
    <a href="LIF.html">The integrate and fire neuron</a>
  </li>
  <li class="active">
    <a href="">Training a Perceptron</a>
  </li>
</ul>
</nav>
<p class="navbar_footer"></p>
</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse" data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu" aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation" title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i class="fas fa-download"></i></button>

            
            <div class="dropdown-buttons">
                <!-- ipynb file if we had a myst markdown file -->
                
                <!-- Download raw file -->
                <a class="dropdown-buttons" href="_sources/perceptron.ipynb"><button type="button" class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip" data-placement="left">.ipynb</button></a>
                <!-- Download PDF via print -->
                <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF" onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
            </div>
            
        </div>

        <!-- Edit this page -->
        

        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->
        
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
            <div class="dropdown-buttons">
                
                <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/perceptron.ipynb"><button type="button" class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip" data-placement="left"><img class="binder-button-logo" src="_static/images/logo_binder.svg" alt="Interact on binder">Binder</button></a>
                
                
                
            </div>
        </div>
        

        
    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#preliminaries" class="nav-link">Preliminaries</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#part-1-a-simple-perceptron-model" class="nav-link">Part 1:   A simple perceptron model.</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#part-2-build-a-perceptron-classifier" class="nav-link">Part 2.  Build a perceptron classifier.</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#step-1-provide-perceptron-with-inputs-and-known-answer" class="nav-link">Step 1. Provide perceptron with inputs and known answer.</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#step-2-ask-perceptron-to-guess-an-answer" class="nav-link">Step 2: Ask perceptron to guess an answer.</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#step-3-compute-the-error" class="nav-link">Step 3: Compute the error.</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#step-4-adjust-all-weights-according-to-the-error" class="nav-link">Step 4: Adjust all weights according to the error.</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#step-5-return-to-step-1-and-repeat" class="nav-link">Step 5: Return to Step 1 and repeat …</a>
        </li>
    
            </ul>
        </li>
    
    </ul>
</nav>


    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 col-xxl-7 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="training-a-perceptron">
<h1>Training a Perceptron<a class="headerlink" href="#training-a-perceptron" title="Permalink to this headline">¶</a></h1>
<p>In this module, we will construct simple perceptron models. We’ll start by implementing a perceptron model, and seeing how it behaves. We’ll then outline the steps to train a perceptron to classify a point as above or below a line.</p>
<p>This discussion follows the excellent example and discussion at <a class="reference external" href="https://natureofcode.com/book/chapter-10-neural-networks/">The Nature of Code</a>. Please see that reference for additional details, and a more sophisticated coding strategy (using Classes in Python).</p>
<div class="section" id="preliminaries">
<h2>Preliminaries<a class="headerlink" href="#preliminaries" title="Permalink to this headline">¶</a></h2>
<p>Text preceded by a <code class="docutils literal notranslate"><span class="pre">#</span></code> indicates a ‘comment’.  I will use comments to explain what we’re doing and to ask you questions.  Also, comments are useful in your own code to note what you’ve done (so it makes sense when you return to the code in the future).  It’s a good habit to <em>always</em> comment your code.  I’ll try to set a good example, but won’t always …</p>
<p>Before beginning, let’s load in the Python packages we’ll need:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">time</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="part-1-a-simple-perceptron-model">
<h2>Part 1:   A simple perceptron model.<a class="headerlink" href="#part-1-a-simple-perceptron-model" title="Permalink to this headline">¶</a></h2>
<p>Let’s examine a simple perceptron that accepts inputs, processes those inputs, and returns an output. To do so, please consider this function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_perceptron</span><span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
    <span class="c1"># Define the activity of the perceptron, x.</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">input1</span><span class="o">*</span><span class="n">w1</span> <span class="o">+</span> <span class="n">input2</span><span class="o">*</span><span class="n">w2</span> <span class="o">+</span> <span class="n">theta</span>
    
    <span class="c1"># Apply a binary threshold,</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-info">
<p><strong>Q:</strong> How many inputs does the function take?  How many outputs does it return?<p></p></p>
<p><strong>Q:</strong> Looking at this code, could you sketch a model of this perceptron?<p></p></p>
<p><strong>Q:</strong> Apply this function to different sets of inputs. Consider,<p></p></p>
<p><code class="docutils literal notranslate"><span class="pre">input1</span> <span class="pre">=</span> <span class="pre">1,</span> <span class="pre">input2</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">w1</span> <span class="pre">=</span> <span class="pre">0.5,</span> <span class="pre">w2</span> <span class="pre">=</span> <span class="pre">-0.5,</span> <span class="pre">theta</span> <span class="pre">=</span> <span class="pre">0</span></code><p></p></p>
<p>and<p></p></p>
<p><code class="docutils literal notranslate"><span class="pre">input1</span> <span class="pre">=</span> <span class="pre">1,</span> <span class="pre">input2</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">w1</span> <span class="pre">=</span> <span class="pre">0.5,</span> <span class="pre">w2</span> <span class="pre">=</span> <span class="pre">-0.5,</span> <span class="pre">theta</span> <span class="pre">=</span> <span class="pre">-1</span></code><p></p></p>
<p>What do you find?</p>
</div></div>
<div class="section" id="part-2-build-a-perceptron-classifier">
<h2>Part 2.  Build a perceptron classifier.<a class="headerlink" href="#part-2-build-a-perceptron-classifier" title="Permalink to this headline">¶</a></h2>
<p>We’d like to create a method to train a perceptron to classify a point (x,y) as above or below a line. Let’s implement this training procedure.</p>
<div class="section" id="step-1-provide-perceptron-with-inputs-and-known-answer">
<h3>Step 1. Provide perceptron with inputs and known answer.<a class="headerlink" href="#step-1-provide-perceptron-with-inputs-and-known-answer" title="Permalink to this headline">¶</a></h3>
<p>First, let’s make a function that computes a line, and determines if
a given <code class="docutils literal notranslate"><span class="pre">y</span></code> value is above or below the line. We’ll use this function
to return the correct (“known”) answer. Having known answers is
important for training the perceptron. We’ll use the known answers to
tell the when it’s right or wrong (i.e., when the perceptron makes an
error).</p>
<p>Let’s define the function (<code class="docutils literal notranslate"><span class="pre">known_answer</span></code>) should take four inputs:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">slope</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">intercept</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code></p></li>
</ul>
<p>where the (x,y) value is a point we choose on the plane. The function
should return one output:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">desired_output</span></code></p></li>
</ul>
<p>where,</p>
<p><code class="docutils literal notranslate"><span class="pre">desired_output</span> <span class="pre">=</span> <span class="pre">1</span></code>, if the <code class="docutils literal notranslate"><span class="pre">y</span></code> value (the last input) is above the line,</p>
<p><code class="docutils literal notranslate"><span class="pre">desired_putput</span> <span class="pre">=</span> <span class="pre">0</span></code>, if the <code class="docutils literal notranslate"><span class="pre">y</span></code> value (the last input) is below the line.</p>
<p>Consider the function below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">known_answer</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>

  <span class="n">yline</span> <span class="o">=</span> <span class="n">slope</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">intercept</span>  <span class="c1"># Compute y-value on the line.</span>
  <span class="k">if</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="n">yline</span><span class="p">:</span>                <span class="c1"># If the input y value is above the line,</span>
      <span class="k">return</span> <span class="mi">1</span>                 <span class="c1"># ... indicate this with output = 1;</span>
  <span class="k">else</span><span class="p">:</span>                        <span class="c1"># Otherwise, the input y is below the line,</span>
      <span class="k">return</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-info">
<p><strong>Q:</strong> Consider the (x,y) point,<p></p></p>
<p><code class="docutils literal notranslate"><span class="pre">x,y</span> <span class="pre">=</span> <span class="pre">0.7,3</span></code> <p></p></p>
<p>and the line with slope and intercept, <p></p></p>
<p><code class="docutils literal notranslate"><span class="pre">slope</span> <span class="pre">=</span> <span class="pre">2</span></code> <br></br>
<code class="docutils literal notranslate"><span class="pre">intercept</span> <span class="pre">=</span> <span class="pre">1</span></code><p></p></p>
<p>Is the (x,y) point above or below the line?<p></p>
<br></p>
<p><strong>A:</strong> To answer this, let’s ask our function,</p>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span><span class="mi">3</span>
<span class="n">slope</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">correct_answer</span> <span class="o">=</span> <span class="n">known_answer</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">correct_answer</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-info">
<p><strong>A (Continued):</strong> We find a <code class="docutils literal notranslate"><span class="pre">correct_answer</span></code> of 1.<p></p></p>
<p>So, the point <code class="docutils literal notranslate"><span class="pre">(x,y)=(0.7,3)</span></code> is above the line with slope 2 and intercept 1.</p>
</div></div>
<div class="section" id="step-2-ask-perceptron-to-guess-an-answer">
<h3>Step 2: Ask perceptron to guess an answer.<a class="headerlink" href="#step-2-ask-perceptron-to-guess-an-answer" title="Permalink to this headline">¶</a></h3>
<p>Our next step is to compare our desired output (computed in Step 1) to
the output guessed by the perceptron. To do so, we’ll need to compute
the <em>feedforward</em> solution for the perceptron (i.e., given the inputs
and bias, determine the perceptron output). Let’s do so,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">feedforward</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">wx</span><span class="p">,</span> <span class="n">wy</span><span class="p">,</span> <span class="n">wb</span><span class="p">):</span>

  <span class="c1"># Fix the bias.</span>
  <span class="n">bias</span> <span class="o">=</span> <span class="mi">1</span>

  <span class="c1"># Define the activity of the neuron, activity.</span>
  <span class="n">activity</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">wx</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">wy</span> <span class="o">+</span> <span class="n">wb</span><span class="o">*</span><span class="n">bias</span>
  
  <span class="c1"># Apply the binary threshold,</span>
  <span class="k">if</span> <span class="n">activity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">return</span> <span class="mi">1</span>
  <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<p>This function takes five inputs:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code>  = the x coordinate of the point we choose in the plane.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code>  = the y coordinate of the point we choose in the plane.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wx</span></code> = the weight of x input.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wy</span></code> = the weight of y input.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wb</span></code> = the weight of the bias.</p></li>
</ul>
<p>And this function returns one output:</p>
<ul class="simple">
<li><p>the perceptron’s guess, is the point above (=1) or below (=0) the line.</p></li>
</ul>
<div class="alert alert-block alert-info">
**Q:**  Again consider the (x,y) point, <p></p>
<p><code class="docutils literal notranslate"><span class="pre">x,y</span> <span class="pre">=</span> <span class="pre">0.7,3</span></code> <p></p></p>
<p>and set initial values for the perceptron weights. Let’s just set these all to 0.5;  our goal in the rest of this module will be to train the perceptron by adjusting these weights.  But for now,<p></p></p>
<p><code class="docutils literal notranslate"><span class="pre">wx,wy,wb</span> <span class="pre">=</span> <span class="pre">0.5</span></code> <p></p></p>
<p>Then, ask the perceptron for it’s guess for it’s guess, is the point above or below the line?<p></p></p>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span><span class="mi">3</span>
<span class="n">wx</span><span class="p">,</span><span class="n">wy</span><span class="p">,</span><span class="n">wb</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="p">[</span><span class="mf">0.5</span><span class="p">]</span>
<span class="n">perceptron_guess</span> <span class="o">=</span> <span class="n">feedforward</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">wx</span><span class="p">,</span> <span class="n">wy</span><span class="p">,</span> <span class="n">wb</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">perceptron_guess</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-info">
<p><strong>A (Continued):</strong> We find a <code class="docutils literal notranslate"><span class="pre">peceptron_guess</span></code> of 1.<br></p>
<p>
<p>So, the perceptron guesses that the point <code class="docutils literal notranslate"><span class="pre">(x,y)=(0.7,3)</span></code> is above the line.</p>
</div></div>
<div class="section" id="step-3-compute-the-error">
<h3>Step 3: Compute the error.<a class="headerlink" href="#step-3-compute-the-error" title="Permalink to this headline">¶</a></h3>
<p>We’ve now answered the question “<em>Is the (x,y) point above the line?</em>” in
two ways:</p>
<ul class="simple">
<li><p>the known answer, and</p></li>
<li><p>the perceptron’s guess.</p></li>
</ul>
<p>Let’s compute the error as the difference between these two answers:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">error</span> <span class="o">=</span> <span class="n">correct_answer</span> <span class="o">-</span> <span class="n">perceptron_guess</span>
<span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-info">
**Q:**  What do you find for the `error`? Does it make sense?
</div></div>
<div class="section" id="step-4-adjust-all-weights-according-to-the-error">
<h3>Step 4: Adjust all weights according to the error.<a class="headerlink" href="#step-4-adjust-all-weights-according-to-the-error" title="Permalink to this headline">¶</a></h3>
<p>To update the weights, we’ll use the expression,</p>
<p><code class="docutils literal notranslate"><span class="pre">new</span> <span class="pre">weight</span> <span class="pre">=</span> <span class="pre">weight</span> <span class="pre">+</span> <span class="pre">error</span> <span class="pre">*</span> <span class="pre">input</span> <span class="pre">*</span> <span class="pre">learning</span> <span class="pre">constant</span></code></p>
<p>We need to compute this for each weight <code class="docutils literal notranslate"><span class="pre">(wx,</span> <span class="pre">wy,</span> <span class="pre">wb)</span></code>.</p>
<p>First, let’s set the learning constant,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">learning_constant</span> <span class="o">=</span> <span class="mf">0.01</span>
</pre></div>
</div>
</div>
</div>
<p>Then, we can compute the new weights,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wx</span> <span class="o">=</span> <span class="n">wx</span> <span class="o">+</span> <span class="n">error</span><span class="o">*</span><span class="n">x</span>   <span class="o">*</span><span class="n">learning_constant</span>
<span class="n">wy</span> <span class="o">=</span> <span class="n">wy</span> <span class="o">+</span> <span class="n">error</span><span class="o">*</span><span class="n">y</span>   <span class="o">*</span><span class="n">learning_constant</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">wb</span> <span class="o">+</span> <span class="n">error</span><span class="o">*</span><span class="mi">1</span>   <span class="o">*</span><span class="n">learning_constant</span>
</pre></div>
</div>
</div>
</div>
<p>Notice that, in the update to <code class="docutils literal notranslate"><span class="pre">wb</span></code> we use the fact that the bias equals 1.</p>
<div class="alert alert-block alert-info">
**Q:**  What do you find for the new weights? Does it make sense?
</div></div>
<div class="section" id="step-5-return-to-step-1-and-repeat">
<h3>Step 5: Return to Step 1 and repeat …<a class="headerlink" href="#step-5-return-to-step-1-and-repeat" title="Permalink to this headline">¶</a></h3>
<p>We could try to compute these repetitions by hand, for example by repeating
the cells above. To do so, we’d choose a new point in the (x,y) plane,
determine whether it’s above the line 2x+1, ask the perceptron to guess
whether it’s above the line, then use the error to update the
perceptron’s weights.</p>
<p>But we want to evaluate this procedure 2000 times. Doing so by
hand would be a total pain, and highly error prone. Instead, let’s
ask the computer to do the boring work of multiple repetitions. To do so,
let’s collect the code above, and examine 2000 (x,y) points chosen
randomly in the plane. We’ll wrap our code above inside a for-loop to
make this efficient,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">slope</span>     <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>                      <span class="c1"># Define the line with slope, </span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>                      <span class="c1"># ... and intercept.</span>

<span class="n">wx</span><span class="p">,</span><span class="n">wy</span><span class="p">,</span><span class="n">wz</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="p">[</span><span class="mf">0.5</span><span class="p">];</span>                 <span class="c1"># Choose initial values for the perceptron&#39;s weights</span>

<span class="n">learning_constant</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span>           <span class="c1"># And, set the learning constant.</span>

<span class="n">estimated_slope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>    <span class="c1"># Variables to hold the perceptron estimates.</span>
<span class="n">estimated_intercept</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2000</span><span class="p">):</span>           <span class="c1"># For 2000 iteractions,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>         <span class="c1"># Choose a random (x,y) point in the plane</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
                                    <span class="c1"># Step 1: Calculate known answer.</span>
    <span class="n">correct_answer</span> <span class="o">=</span> <span class="n">known_answer</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
    
                                    <span class="c1"># Step 2. Ask perceptron to guess an answer.</span>
    <span class="n">perceptron_guess</span> <span class="o">=</span> <span class="n">feedforward</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">wx</span><span class="p">,</span> <span class="n">wy</span><span class="p">,</span> <span class="n">wb</span><span class="p">);</span>
    
                                    <span class="c1"># Step 3. Compute the error.</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">correct_answer</span> <span class="o">-</span> <span class="n">perceptron_guess</span><span class="p">;</span>
    
                                    <span class="c1"># Step 4. Adjust weights according to error.</span>
    <span class="n">wx</span> <span class="o">=</span> <span class="n">wx</span> <span class="o">+</span> <span class="n">error</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">learning_constant</span><span class="p">;</span>
    <span class="n">wy</span> <span class="o">=</span> <span class="n">wy</span> <span class="o">+</span> <span class="n">error</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">learning_constant</span><span class="p">;</span>
    <span class="n">wb</span> <span class="o">=</span> <span class="n">wb</span> <span class="o">+</span> <span class="n">error</span><span class="o">*</span><span class="mi">1</span><span class="o">*</span><span class="n">learning_constant</span><span class="p">;</span>
     
    <span class="n">estimated_slope</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">wx</span><span class="o">/</span><span class="n">wy</span><span class="p">;</span>    <span class="c1"># Compute estimated slope from perceptron.</span>
    <span class="n">estimated_intercept</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">wb</span><span class="o">/</span><span class="n">wy</span><span class="p">;</span><span class="c1"># Compute estimated intercept from perceptron.</span>

<span class="c1"># Display the results! ------------------------------------------------------------------------</span>
<span class="n">x_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">);</span>                  <span class="c1"># For a range of x-values,</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">slope</span><span class="o">*</span><span class="n">x_range</span><span class="o">+</span><span class="n">intercept</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>    <span class="c1"># ... plot the true line,</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span><span class="mi">100</span><span class="p">):</span>                       <span class="c1"># ... and plot some intermediate perceptron guess</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">estimated_slope</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">x_range</span><span class="o">+</span><span class="n">estimated_intercept</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
                                                  <span class="c1"># ... and plot the last perceptron guess</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">estimated_slope</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x_range</span><span class="o">+</span><span class="n">estimated_intercept</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Known answer (black), Perceptron final guess (blue)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/perceptron_27_0.png" src="_images/perceptron_27_0.png" />
</div>
</div>
</div>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="LIF.html" title="previous page">The integrate and fire neuron</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2020.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.4.<br/>
    </p>
  </div>
</footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>