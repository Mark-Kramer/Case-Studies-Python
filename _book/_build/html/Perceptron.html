

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Training a Perceptron &#8212; Case Studies in Neural Data Analysis</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/mystnb.js"></script>
    <script src="_static/custom.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script async="async" src="_static/thebelab.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="canonical" href="https://mark-kramer.github.io/Case-Studies-Python/Perceptron.html" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Backpropagation" href="Backprop.html" />
    <link rel="prev" title="The Hodgkin-Huxley model" href="HH.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">


<!-- Opengraph tags -->
<meta property="og:url"         content="https://mark-kramer.github.io/Case-Studies-Python/Perceptron.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Training a Perceptron" />
<meta property="og:description" content="Training a Perceptron  In this notebook, we will construct simple perceptron models. We’ll start by implementing a perceptron model, and seeing how it behaves. " />
<meta property="og:image"       content="https://mark-kramer.github.io/Case-Studies-Python/_static/logo.png" />

<meta name="twitter:card" content="summary">


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Case Studies in Neural Data Analysis</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
  <li class="">
    <a href="01.html">1. Python for the practicing neuroscientist</a>
  </li>
  <li class="">
    <a href="02.html">2. The Event-Related Potential</a>
  </li>
  <li class="">
    <a href="03.html">3. The Power Spectrum (Part 2)</a>
  </li>
  <li class="">
    <a href="04.html">4. The Power Spectrum (Part 2)</a>
  </li>
  <li class="">
    <a href="05.html">5. Analysis of coupled rhythms</a>
  </li>
  <li class="">
    <a href="06.html">6. Filtering Field Data</a>
  </li>
  <li class="">
    <a href="07.html">7. Cross-frequency coupling</a>
  </li>
  <li class="">
    <a href="08.html">8. Basic Analysis of Spike Train Data</a>
  </li>
  <li class="">
    <a href="09.html">9. Point Process Generalized Linear Models</a>
  </li>
  <li class="">
    <a href="10.html">10. Analysis of Rhythmic Spike Train Data</a>
  </li>
  <li class="">
    <a href="11.html">11. Spike-field coherence</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Mechanistic Models (beta version)</p>
</li>
  <li class="">
    <a href="IF.html">12. The integrate and fire neuron</a>
  </li>
  <li class="">
    <a href="HH.html">13. The Hodgkin-Huxley model</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Machine Learning (beta version)</p>
</li>
  <li class="active">
    <a href="">14. Training a Perceptron</a>
  </li>
  <li class="">
    <a href="Backprop.html">15. Backpropagation</a>
  </li>
</ul>
</nav>

 <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse" data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu" aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation" title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i class="fas fa-download"></i></button>

            
            <div class="dropdown-buttons">
                <!-- ipynb file if we had a myst markdown file -->
                
                <!-- Download raw file -->
                <a class="dropdown-buttons" href="_sources/Perceptron.ipynb"><button type="button" class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip" data-placement="left">.ipynb</button></a>
                <!-- Download PDF via print -->
                <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF" onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
            </div>
            
        </div>

        <!-- Source interaction buttons -->
        
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
            <div class="dropdown-buttons sourcebuttons">
                <a class="repository-button" href="https://github.com/eschlaf2/Case-Studies-Python"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left" title="Source repository"><i class="fab fa-github"></i>repository</button></a>
                <a class="issues-button" href="https://github.com/eschlaf2/Case-Studies-Python/issues/new?title=Issue%20on%20page%20%2FPerceptron.html&body=Your%20issue%20content%20here."><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left" title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
                
            </div>
        </div>
        

        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->
        
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
            <div class="dropdown-buttons">
                
                <a class="binder-button" href="https://mybinder.org/v2/gh/eschlaf2/Case-Studies-Python/master?urlpath=tree/_book/Perceptron.ipynb"><button type="button" class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip" data-placement="left"><img class="binder-button-logo" src="_static/images/logo_binder.svg" alt="Interact on binder">Binder</button></a>
                
                
                <button type="button" class="btn btn-secondary topbarbtn thebelab-launch-button" onclick="initThebelab()" title="Launch Thebelab" data-toggle="tooltip" data-placement="left"><i class="fas fa-rocket"></i><span style="margin-left: .4em;">ThebeLab</span></button>
                
            </div>
        </div>
        
    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#preliminaries" class="nav-link">Preliminaries</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#part-1-a-simple-perceptron-model" class="nav-link">Part 1:   A simple perceptron model.</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#part-2-build-a-perceptron-classifier" class="nav-link">Part 2.  Build a perceptron classifier.</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#step-1-provide-perceptron-with-inputs-and-known-answer" class="nav-link">Step 1. Provide perceptron with inputs and known answer.</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#step-2-ask-perceptron-to-guess-an-answer" class="nav-link">Step 2: Ask perceptron to guess an answer.</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#step-3-compute-the-error" class="nav-link">Step 3: Compute the error.</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#step-4-adjust-all-weights-according-to-the-error" class="nav-link">Step 4: Adjust all weights according to the error.</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#step-5-return-to-step-1-and-repeat" class="nav-link">Step 5: Return to Step 1 and repeat …</a>
        </li>
    
            </ul>
        </li>
    
    </ul>
</nav>


    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="training-a-perceptron">
<h1>Training a Perceptron<a class="headerlink" href="#training-a-perceptron" title="Permalink to this headline">¶</a></h1>
<p>In this notebook, we will construct simple perceptron models. We’ll start by implementing a perceptron model, and seeing how it behaves. We’ll then outline the steps to train a perceptron to classify a point as above or below a line.</p>
<p>This discussion follows the excellent example and discussion at <a class="reference external" href="https://natureofcode.com/book/chapter-10-neural-networks/">The Nature of Code</a>. Please see that reference for additional details, and a more sophisticated coding strategy (using Classes in Python).</p>
<div class="section" id="preliminaries">
<h2>Preliminaries<a class="headerlink" href="#preliminaries" title="Permalink to this headline">¶</a></h2>
<p>Text preceded by a <code class="docutils literal notranslate"><span class="pre">#</span></code> indicates a ‘comment’.  I will use comments to explain what we’re doing and to ask you questions.  Also, comments are useful in your own code to note what you’ve done (so it makes sense when you return to the code in the future).  It’s a good habit to <em>always</em> comment your code.  I’ll try to set a good example, but won’t always …</p>
<p>Before beginning, let’s load in the Python packages we’ll need:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="o">*</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="part-1-a-simple-perceptron-model">
<h2>Part 1:   A simple perceptron model.<a class="headerlink" href="#part-1-a-simple-perceptron-model" title="Permalink to this headline">¶</a></h2>
<p>Let’s examine a simple perceptron that accepts inputs, processes those inputs, and returns an output. To do so, please consider this function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_perceptron</span><span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
    <span class="c1"># Define the activity of the perceptron, x.</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">input1</span><span class="o">*</span><span class="n">w1</span> <span class="o">+</span> <span class="n">input2</span><span class="o">*</span><span class="n">w2</span> <span class="o">+</span> <span class="n">theta</span>
    
    <span class="c1"># Apply a binary threshold,</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<div class="question">
<p><strong>Q:</strong> How many inputs does the function take?  How many outputs does it return?</p>
<p><strong>Q:</strong> Looking at this code, could you sketch a model of this perceptron?</p>
<p><strong>Q:</strong> Apply this function to different sets of inputs. Consider,</p>
<p><code class="docutils literal notranslate"><span class="pre">input1</span> <span class="pre">=</span> <span class="pre">1,</span> <span class="pre">input2</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">w1</span> <span class="pre">=</span> <span class="pre">0.5,</span> <span class="pre">w2</span> <span class="pre">=</span> <span class="pre">-0.5,</span> <span class="pre">theta</span> <span class="pre">=</span> <span class="pre">0</span></code></p>
<p>and</p>
<p><code class="docutils literal notranslate"><span class="pre">input1</span> <span class="pre">=</span> <span class="pre">1,</span> <span class="pre">input2</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">w1</span> <span class="pre">=</span> <span class="pre">0.5,</span> <span class="pre">w2</span> <span class="pre">=</span> <span class="pre">-0.5,</span> <span class="pre">theta</span> <span class="pre">=</span> <span class="pre">-1</span></code></p>
<p>What do you find?</p>
</div></div>
<div class="section" id="part-2-build-a-perceptron-classifier">
<h2>Part 2.  Build a perceptron classifier.<a class="headerlink" href="#part-2-build-a-perceptron-classifier" title="Permalink to this headline">¶</a></h2>
<p>We’d like to create a method to train a perceptron to classify a point (x,y) as above or below a line. Let’s implement this training procedure.</p>
<div class="section" id="step-1-provide-perceptron-with-inputs-and-known-answer">
<h3>Step 1. Provide perceptron with inputs and known answer.<a class="headerlink" href="#step-1-provide-perceptron-with-inputs-and-known-answer" title="Permalink to this headline">¶</a></h3>
<p>First, let’s make a function that computes a line, and determines if
a given <code class="docutils literal notranslate"><span class="pre">y</span></code> value is above or below the line. We’ll use this function
to return the correct (“known”) answer. Having known answers is
important for training the perceptron. We’ll use the known answers to
tell the when it’s right or wrong (i.e., when the perceptron makes an
error).</p>
<p>Let’s define the function (<code class="docutils literal notranslate"><span class="pre">known_answer</span></code>) should take four inputs:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">slope</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">intercept</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code></p></li>
</ul>
<p>where the (x,y) value is a point we choose on the plane. The function
should return one output:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">desired_output</span></code></p></li>
</ul>
<p>where,</p>
<p><code class="docutils literal notranslate"><span class="pre">desired_output</span> <span class="pre">=</span> <span class="pre">1</span></code>, if the <code class="docutils literal notranslate"><span class="pre">y</span></code> value (the last input) is above the line,</p>
<p><code class="docutils literal notranslate"><span class="pre">desired_putput</span> <span class="pre">=</span> <span class="pre">0</span></code>, if the <code class="docutils literal notranslate"><span class="pre">y</span></code> value (the last input) is below the line.</p>
<p>Consider the function below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">known_answer</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>

  <span class="n">yline</span> <span class="o">=</span> <span class="n">slope</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">intercept</span>  <span class="c1"># Compute y-value on the line.</span>
  <span class="k">if</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="n">yline</span><span class="p">:</span>                <span class="c1"># If the input y value is above the line,</span>
      <span class="k">return</span> <span class="mi">1</span>                 <span class="c1"># ... indicate this with output = 1;</span>
  <span class="k">else</span><span class="p">:</span>                        <span class="c1"># Otherwise, the input y is below the line,</span>
      <span class="k">return</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<div class="question">
<p><strong>Q:</strong> Consider the (x,y) point,</p>
<p><code class="docutils literal notranslate"><span class="pre">x,y</span> <span class="pre">=</span> <span class="pre">0.7,3</span></code></p>
<p>and the line with slope and intercept,</p>
<p><code class="docutils literal notranslate"><span class="pre">slope</span> <span class="pre">=</span> <span class="pre">2</span></code>
<code class="docutils literal notranslate"><span class="pre">intercept</span> <span class="pre">=</span> <span class="pre">1</span></code></p>
<p>Is the (x,y) point above or below the line?</p>
<p><strong>A:</strong> To answer this, let’s ask our function,</p>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span><span class="mi">3</span>
<span class="n">slope</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">correct_answer</span> <span class="o">=</span> <span class="n">known_answer</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">correct_answer</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<div class="question">
<p><strong>A (Continued):</strong> We find a <code class="docutils literal notranslate"><span class="pre">correct_answer</span></code> of 1.</p>
<p>So, the point <code class="docutils literal notranslate"><span class="pre">(x,y)=(0.7,3)</span></code> is above the line with slope 2 and intercept 1.</p>
</div></div>
<div class="section" id="step-2-ask-perceptron-to-guess-an-answer">
<h3>Step 2: Ask perceptron to guess an answer.<a class="headerlink" href="#step-2-ask-perceptron-to-guess-an-answer" title="Permalink to this headline">¶</a></h3>
<p>Our next step is to compare our desired output (computed in Step 1) to
the output guessed by the perceptron. To do so, we’ll need to compute
the <em>feedforward</em> solution for the perceptron (i.e., given the inputs
and bias, determine the perceptron output). Let’s do so,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">feedforward</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">wx</span><span class="p">,</span> <span class="n">wy</span><span class="p">,</span> <span class="n">wb</span><span class="p">):</span>

  <span class="c1"># Fix the bias.</span>
  <span class="n">bias</span> <span class="o">=</span> <span class="mi">1</span>

  <span class="c1"># Define the activity of the neuron, activity.</span>
  <span class="n">activity</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">wx</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">wy</span> <span class="o">+</span> <span class="n">wb</span><span class="o">*</span><span class="n">bias</span>
  
  <span class="c1"># Apply the binary threshold,</span>
  <span class="k">if</span> <span class="n">activity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">return</span> <span class="mi">1</span>
  <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<p>This function takes five inputs:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code>  = the x coordinate of the point we choose in the plane.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code>  = the y coordinate of the point we choose in the plane.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wx</span></code> = the weight of x input.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wy</span></code> = the weight of y input.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wb</span></code> = the weight of the bias.</p></li>
</ul>
<p>And this function returns one output:</p>
<ul class="simple">
<li><p>the perceptron’s guess, is the point above (=1) or below (=0) the line.</p></li>
</ul>
<div class="question">
<p><strong>Q:</strong>  Again consider the (x,y) point,</p>
<p><code class="docutils literal notranslate"><span class="pre">x,y</span> <span class="pre">=</span> <span class="pre">0.7,3</span></code></p>
<p>and set initial values for the perceptron weights. Let’s just set these all to 0.5;  our goal in the rest of this notebook will be to train the perceptron by adjusting these weights.  But for now,</p>
<p><code class="docutils literal notranslate"><span class="pre">wx,wy,wb</span> <span class="pre">=</span> <span class="pre">0.5</span></code></p>
<p>Then, ask the perceptron for it’s guess for it’s guess, is the point above or below the line?</p>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mi">3</span>
<span class="n">wx</span><span class="p">,</span><span class="n">wy</span><span class="p">,</span><span class="n">wb</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span>
<span class="n">perceptron_guess</span> <span class="o">=</span> <span class="n">feedforward</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">wx</span><span class="p">,</span> <span class="n">wy</span><span class="p">,</span> <span class="n">wb</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">perceptron_guess</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<div class="question">
<p><strong>A (Continued):</strong> We find a <code class="docutils literal notranslate"><span class="pre">peceptron_guess</span></code> of 1.</p>
<p>So, the perceptron guesses that the point <code class="docutils literal notranslate"><span class="pre">(x,y)=(0.7,3)</span></code> is above the line.</p>
</div></div>
<div class="section" id="step-3-compute-the-error">
<h3>Step 3: Compute the error.<a class="headerlink" href="#step-3-compute-the-error" title="Permalink to this headline">¶</a></h3>
<p>We’ve now answered the question “<em>Is the (x,y) point above the line?</em>” in
two ways:</p>
<ul class="simple">
<li><p>the known answer, and</p></li>
<li><p>the perceptron’s guess.</p></li>
</ul>
<p>Let’s compute the error as the difference between these two answers:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">error</span> <span class="o">=</span> <span class="n">correct_answer</span> <span class="o">-</span> <span class="n">perceptron_guess</span>
<span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="question">
<p><strong>Q:</strong>  What do you find for the <code class="docutils literal notranslate"><span class="pre">error</span></code>? Does it make sense?</p>
</div></div>
<div class="section" id="step-4-adjust-all-weights-according-to-the-error">
<h3>Step 4: Adjust all weights according to the error.<a class="headerlink" href="#step-4-adjust-all-weights-according-to-the-error" title="Permalink to this headline">¶</a></h3>
<p>To update the weights, we’ll use the expression,</p>
<p><code class="docutils literal notranslate"><span class="pre">new</span> <span class="pre">weight</span> <span class="pre">=</span> <span class="pre">weight</span> <span class="pre">+</span> <span class="pre">error</span> <span class="pre">*</span> <span class="pre">input</span> <span class="pre">*</span> <span class="pre">learning</span> <span class="pre">constant</span></code></p>
<p>We need to compute this for each weight <code class="docutils literal notranslate"><span class="pre">(wx,</span> <span class="pre">wy,</span> <span class="pre">wb)</span></code>.</p>
<p>First, let’s set the learning constant,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">learning_constant</span> <span class="o">=</span> <span class="mf">0.01</span>
</pre></div>
</div>
</div>
</div>
<p>Then, we can compute the new weights,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wx</span> <span class="o">=</span> <span class="n">wx</span> <span class="o">+</span> <span class="n">error</span><span class="o">*</span><span class="n">x</span>   <span class="o">*</span><span class="n">learning_constant</span>
<span class="n">wy</span> <span class="o">=</span> <span class="n">wy</span> <span class="o">+</span> <span class="n">error</span><span class="o">*</span><span class="n">y</span>   <span class="o">*</span><span class="n">learning_constant</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">wb</span> <span class="o">+</span> <span class="n">error</span><span class="o">*</span><span class="mi">1</span>   <span class="o">*</span><span class="n">learning_constant</span>
</pre></div>
</div>
</div>
</div>
<p>Notice that, in the update to <code class="docutils literal notranslate"><span class="pre">wb</span></code> we use the fact that the bias equals 1.</p>
<div class="question">
<p><strong>Q:</strong>  What do you find for the new weights? Does it make sense?</p>
</div></div>
<div class="section" id="step-5-return-to-step-1-and-repeat">
<h3>Step 5: Return to Step 1 and repeat …<a class="headerlink" href="#step-5-return-to-step-1-and-repeat" title="Permalink to this headline">¶</a></h3>
<p>We could try to compute these repetitions by hand, for example by repeating
the cells above. To do so, we’d choose a new point in the (x,y) plane,
determine whether it’s above the line 2x+1, ask the perceptron to guess
whether it’s above the line, then use the error to update the
perceptron’s weights.</p>
<p>But we want to evaluate this procedure 2000 times. Doing so by
hand would be a total pain, and highly error prone. Instead, let’s
ask the computer to do the boring work of multiple repetitions. To do so,
let’s collect the code above, and examine 2000 (x,y) points chosen
randomly in the plane. We’ll wrap our code above inside a for-loop to
make this efficient,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">slope</span>     <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>                      <span class="c1"># Define the line with slope, </span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>                      <span class="c1"># ... and intercept.</span>

<span class="n">wx</span><span class="p">,</span><span class="n">wy</span><span class="p">,</span><span class="n">wz</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="p">[</span><span class="mf">0.5</span><span class="p">];</span>                 <span class="c1"># Choose initial values for the perceptron&#39;s weights</span>

<span class="n">learning_constant</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span>           <span class="c1"># And, set the learning constant.</span>

<span class="n">estimated_slope</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>       <span class="c1"># Variables to hold the perceptron estimates.</span>
<span class="n">estimated_intercept</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">arange</span><span class="p">(</span><span class="mi">2000</span><span class="p">):</span>              <span class="c1"># For 2000 iteractions,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>                   <span class="c1"># Choose a random (x,y) point in the plane</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
                                    <span class="c1"># Step 1: Calculate known answer.</span>
    <span class="n">correct_answer</span> <span class="o">=</span> <span class="n">known_answer</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
    
                                    <span class="c1"># Step 2. Ask perceptron to guess an answer.</span>
    <span class="n">perceptron_guess</span> <span class="o">=</span> <span class="n">feedforward</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">wx</span><span class="p">,</span> <span class="n">wy</span><span class="p">,</span> <span class="n">wb</span><span class="p">);</span>
    
                                    <span class="c1"># Step 3. Compute the error.</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">correct_answer</span> <span class="o">-</span> <span class="n">perceptron_guess</span><span class="p">;</span>
    
                                    <span class="c1"># Step 4. Adjust weights according to error.</span>
    <span class="n">wx</span> <span class="o">=</span> <span class="n">wx</span> <span class="o">+</span> <span class="n">error</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">learning_constant</span><span class="p">;</span>
    <span class="n">wy</span> <span class="o">=</span> <span class="n">wy</span> <span class="o">+</span> <span class="n">error</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">learning_constant</span><span class="p">;</span>
    <span class="n">wb</span> <span class="o">=</span> <span class="n">wb</span> <span class="o">+</span> <span class="n">error</span><span class="o">*</span><span class="mi">1</span><span class="o">*</span><span class="n">learning_constant</span><span class="p">;</span>
     
    <span class="n">estimated_slope</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">wx</span><span class="o">/</span><span class="n">wy</span><span class="p">;</span>               <span class="c1"># Compute estimated slope from perceptron.</span>
    <span class="n">estimated_intercept</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">wb</span><span class="o">/</span><span class="n">wy</span><span class="p">;</span>           <span class="c1"># Compute estimated intercept from perceptron.</span>

<span class="c1"># Display the results! ------------------------------------------------------------------------</span>
<span class="n">x_range</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">);</span>                  <span class="c1"># For a range of x-values,</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">slope</span><span class="o">*</span><span class="n">x_range</span><span class="o">+</span><span class="n">intercept</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span> <span class="c1"># ... plot the true line,</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span><span class="mi">100</span><span class="p">):</span>                    <span class="c1"># ... and plot some intermediate perceptron guess</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">estimated_slope</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">x_range</span><span class="o">+</span><span class="n">estimated_intercept</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
                                               <span class="c1"># ... and plot the last perceptron guess</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">estimated_slope</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x_range</span><span class="o">+</span><span class="n">estimated_intercept</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="s1">&#39;Known answer (black), Perceptron final guess (blue)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Perceptron_27_0.png" src="_images/Perceptron_27_0.png" />
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "eschlaf2/Case-Studies-Python",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "."
        }
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="HH.html" title="previous page">The Hodgkin-Huxley model</a>
    <a class='right-next' id="next-link" href="Backprop.html" title="next page">Backpropagation</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Mark Kramer and Uri Eden<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>